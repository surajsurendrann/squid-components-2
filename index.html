<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google Reviews Carousel</title>
    <link rel="stylesheet" href="GoogleReviews.css" />
    <!-- <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    /> -->
    <style>
      .sq-googleReviews {
        display: flex;
        flex-direction: column;
        gap: 20px;
        padding: 2rem;
        text-align: center;
        overflow: hidden;
        font-family: "Poppins", Helvetica, "Helvetica Neue", sans-serif;
      }

      .sq-googleReviews__title {
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .sq-googleReviews__summary {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem;
        border-radius: 8px;
        background: #f1f1f1;
        font-family: "Poppins", Helvetica, "Helvetica Neue", sans-serif;
      }

      .sq-googleReviews__summary-left {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
      }

      .sq-googleReviews__summary-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .sq-googleReviews__googleIcon {
        width: 84px;
        height: auto;
      }

      .sq-googleReviews__label {
        font-weight: 700;
        font-size: 20px;
        color: #333;
      }

      .sq-googleReviews__summary-rating {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        margin-top: 0.3rem;
      }

      .sq-googleReviews__score {
        font-weight: 600;
        font-size: 1.3rem;
        color: #222;
      }

      .sq-googleReviews__count {
        color: #777;
        font-size: 0.9rem;
      }

      .sq-googleReviews__summary-action {
        flex-shrink: 0;
      }

      .sq-googleReviews__button {
        display: inline-block;
        padding: 0.5rem 1rem;
        font-size: 14px;
        background: #4285f4;
        color: #fff;
        font-weight: 500;
        border-radius: 20px;
        text-decoration: none;
        transition: background 0.3s;
        font-weight: bold;
        text-overflow: ellipsis;
        text-wrap: nowrap;
      }

      .sq-googleReviews__button:hover {
        background: #357ae8;
      }

      /* Base star mask (same SVG path you used) */
      .sq-googleReviews__star {
        width: 22px;
        height: 22px;
        display: inline-block;
        background-color: #d2d2d2; /* fallback gray */
        -webkit-mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M12 .587l3.668 7.431 8.2 1.192-5.934 5.782 1.401 8.168L12 18.896l-7.335 3.864 1.401-8.168L.132 9.21l8.2-1.192z'/></svg>")
          no-repeat center / contain;
        mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M12 .587l3.668 7.431 8.2 1.192-5.934 5.782 1.401 8.168L12 18.896l-7.335 3.864 1.401-8.168L.132 9.21l8.2-1.192z'/></svg>")
          no-repeat center / contain;
      }

      /* Fully filled star */
      .sq-googleReviews__star--full {
        background-color: #fbbc05; /* gold */
      }

      /* Fractional star â€“ use CSS variable --fill (0 â†’ 1) */
      .sq-googleReviews__star--fractional {
        background: linear-gradient(
          to right,
          #fbbc05 calc(var(--fill, 0) * 100%),
          #d2d2d2 calc(var(--fill, 0) * 100%)
        );
      }

      /* Review card */
      .sq-googleReviews__card {
        background: #f1f1f1;
        border-radius: 12px;
        padding: 1rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        text-align: left;
      }

      .sq-googleReviews__card-header {
        display: flex;
        align-items: center;
        gap: 0.8rem;
        margin-bottom: 0.6rem;
      }

      .sq-googleReviews__avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
      }

      .sq-googleReviews__name {
        font-size: 1rem;
        font-weight: 600;
        margin: 0;
      }

      .sq-googleReviews__time {
        font-size: 0.85rem;
        color: #888;
      }

      .sq-googleReviews__text {
        font-size: 0.95rem;
        margin: 0.5rem 0;
        color: #444;
      }

      .sq-googleReviews__readMore {
        color: #1a73e8;
        font-size: 0.9rem;
        font-weight: 500;
        text-decoration: none;
      }

      .sq-googleReviews__readMore:hover {
        text-decoration: underline;
      }

      /* Dots */
      .sq-googleReviews__dots {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .sq-googleReviews__dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #ccc;
        cursor: pointer;
      }

      .sq-googleReviews__dot--active {
        background: #1a73e8;
      }

      /* Responsive */
      @media (max-width: 564px) {
        .sq-googleReviews__summary {
          flex-direction: column;
        }
      }

      /* ===== Carousel styles merged here ===== */
      .sq-googleReviews-carousel {
        display: flex;
        flex-direction: column;
        position: relative;
        width: 100%;
        overflow: hidden;
      }

      .sq-googleReviews-carousel__viewport {
        overflow: hidden;
        width: 100%;
      }

      .sq-googleReviews-carousel__track {
        display: grid;
        transition: transform 0.5s ease-in-out;
      }

      .sq-googleReviews-carousel__card {
        box-sizing: border-box;
        display: flex;
        margin: 0 5px;
      }

      .sq-googleReviews-carousel__card--first {
        margin-left: 0;
      }

      .sq-googleReviews-carousel__card--last {
        margin-right: 0;
      }

      .sq-googleReviews-carousel__card--single {
        margin: 0;
      }

      .sq-googleReviews-carousel__button {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        border: none;
        background: rgba(17, 17, 17, 0.381);
        padding: 0.5rem 1rem;
        cursor: pointer;
        z-index: 2;
        font-size: 1.3rem;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        color: #ecececff;
      }

      .sq-googleReviews-carousel__button:hover {
        background: rgba(17, 17, 17, 0.764);
      }

      .sq-googleReviews-carousel__button:active {
        background: rgba(17, 17, 17, 0.9);
      }

      .sq-googleReviews-carousel__button--left {
        left: 10px;
      }

      .sq-googleReviews-carousel__button--right {
        right: 10px;
      }

      .sq-googleReviews-carousel__indicators {
        display: flex;
        flex-direction: row;
        align-items: center;
        margin: 0 auto;
        -ms-overflow-style: none;
        scrollbar-width: none;
        margin-top: 15px;
        max-width: 56px;
        overflow: auto;
        scroll-behavior: smooth; /* ðŸ”¥ smooth scroll */
      }

      .sq-googleReviews-carousel__indicators::-webkit-scrollbar {
        display: none;
      }

      .sq-googleReviews-carousel__indicators > * {
        margin-left: 6px;
        border-radius: 12px;
        transition: all 250ms linear;
      }

      .sq-googleReviews-carousel__indicators > div:first-child {
        margin-left: 0px;
      }

      .sq-googleReviews-carousel__indicators > .dots-active {
        width: 8px;
        height: 8px;
        background-color: #00000096;
        flex-shrink: 0;
        flex-grow: 1;
        cursor: pointer;
      }

      .sq-googleReviews-carousel__indicators > .dots-close {
        width: 6px;
        height: 6px;
        background-color: #00000033;
        flex-shrink: 0;
        flex-grow: 1;
        cursor: pointer;
      }

      .sq-googleReviews-carousel__indicators > .dots-far {
        width: 4px;
        height: 4px;
        margin-top: 1px;
        margin-bottom: 1px;
        background-color: #00000033;
        flex-shrink: 0;
        flex-grow: 1;
        cursor: pointer;
      }

      /* Review Card */
      .sq-googleReviews__reviewCard {
        background: #f1f1f1;
        border-radius: 10px;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        font-family: "Poppins", Helvetica, "Helvetica Neue", sans-serif;
        position: relative;
        align-items: flex-start;
        user-select: none;
        -webkit-user-select: none;
      }

      /* Header Section */
      .sq-googleReviews__reviewCard-headerSection {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        width: 100%;
      }

      .sq-googleReviews__reviewCard-header {
        display: flex;
        gap: 0.8rem;
        align-items: flex-start;
      }

      .sq-googleReviews__reviewCard-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        overflow: hidden;
        background: #008c91ff;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        font-size: 1rem;
        flex-shrink: 0;
        position: relative;
        color: #fff;
      }

      .sq-googleReviews__reviewCard-avatar span {
        color: #fff;
      }

      .sq-googleReviews__reviewCard-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .sq-googleReviews__reviewCard-googleIcon {
        position: absolute;
        top: 40px;
        left: 40px;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #fff;
        padding: 2px;
      }

      .sq-googleReviews__reviewCard-info {
        display: flex;
        flex-direction: column;
      }

      .sq-googleReviews__reviewCard-nameSection {
        display: flex;
        align-items: center;
        gap: 4px;
        min-width: 0;
        flex: 1;
      }

      .sq-googleReviews__reviewCard-nameText {
        font-weight: 600;
        font-size: 15px;
        display: -webkit-box;
        -webkit-line-clamp: 1;
        line-clamp: 1;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        align-items: center;
        gap: 4px;
        text-align: left;
      }

      .sq-googleReviews__reviewCard-verified {
        width: 20px;
      }

      .sq-googleReviews__reviewCard-date {
        font-size: 0.8rem;
        color: #666;
        text-align: left;
      }

      .sq-googleReviews__reviewCard-stars {
        display: flex;
        gap: 2px;
        margin-top: 2px;
      }

      .sq-googleReviews__reviewCard-star {
        width: 24px;
        height: 24px;
        flex-shrink: 0;
      }

      /* Content Section */
      .sq-googleReviews__reviewCard-contentSection {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
        gap: 0.3rem;
        width: 100%;
      }

      .sq-googleReviews__reviewCard-text {
        font-size: 16px;
        text-align: left;
        color: #333;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 4;
        line-clamp: 4;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .sq-googleReviews__reviewCard-readMore {
        display: flex;
        color: #1a73e8;
        font-size: 0.85rem;
        text-decoration: none;
        cursor: pointer;
      }

      .sq-googleReviews__reviewCard-googleBadge {
        position: absolute;
        top: 40px;
        left: 40px;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #fff;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
        border: 1px solid #eee;
        padding: 2px;
        z-index: 2;
      }

      .sq-googleReview_reviewModal {
        background: #fff;
        border-radius: 12px;
        padding: 1.5rem;
        max-width: 500px;
        width: 90%;
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        font-family: "Poppins", Helvetica, "Helvetica Neue", sans-serif;
      }
      .sq-googleReview_reviewModal-nameRow {
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .sq-googleReview_reviewModal-verifiedWrapper {
        display: flex;
        align-items: center;
        height: 100%;
        margin-left: 2px;
      }

      .sq-googleReview_reviewModal-verified {
        width: 20px;
        vertical-align: middle;
        display: inline-block;
      }
      .sq-googleReview_reviewModal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .sq-googleReview_reviewModal-header {
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }

      .sq-googleReview_reviewModal-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        overflow: hidden;
        background: #008c91;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        color: #fff;

        img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }

      .sq-googleReview_reviewModal-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
      }

      .sq-googleReview_reviewModal-name {
        font-weight: 600;
        font-size: 1rem;
      }

      .sq-googleReview_reviewModal-stars {
        color: #fbbc04;
        font-size: 1rem;
      }

      .sq-googleReviews__stars {
        display: flex;
      }

      .sq-googleReview_reviewModal-text {
        font-size: 0.95rem;
        color: #333;
        line-height: 1.5;
        text-align: left;
      }

      .sq-googleReview_reviewModal-date {
        font-size: 0.9rem;
        color: #666;
        text-align: left;
      }

      .sq-googleReview_reviewModal-close {
        position: absolute;
        top: 10px;
        right: 12px;
        background: transparent;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="googleReviews" class="sq-googleReviews">
      <h2 class="sq-googleReviews__title">What Our Customers Say</h2>

      <!-- Summary -->
      <div class="sq-googleReviews__summary">
        <div class="sq-googleReviews__summary-left">
          <div class="sq-googleReviews__summary-header">
            <img
              src="/google.svg"
              alt="Google"
              class="sq-googleReviews__googleIcon"
            />
            <span class="sq-googleReviews__label">Reviews</span>
          </div>
          <div class="sq-googleReviews__summary-rating">
            <span class="sq-googleReviews__score">4.7</span>
            <div id="sq-googlereview-summaryStars" class="sq-googleReviews__stars"></div>
            <span class="sq-googleReviews__count">(16,865)</span>
          </div>
        </div>
        <div class="sq-googleReviews__summary-action">
          <a
            href="https://www.google.com"
            target="_blank"
            rel="noopener noreferrer"
            class="sq-googleReviews__button"
          >
            Review us on Google
          </a>
        </div>
      </div>

      <!-- Carousel -->
      <div class="sq-googleReviews-carousel">
        <button
          class="sq-googleReviews-carousel__button sq-googleReviews-carousel__button--left"
          id="sq-googlereview-prevBtn"
        >
          â€¹
        </button>
  <div class="sq-googleReviews-carousel__viewport" id="sq-googlereview-carouselViewport">
          <div
            class="sq-googleReviews-carousel__track"
            id="sq-googlereview-carouselTrack"
          ></div>
        </div>
        <button
          class="sq-googleReviews-carousel__button sq-googleReviews-carousel__button--right"
          id="sq-googlereview-nextBtn"
        >
          â€º
        </button>
        <div
          class="sq-googleReviews-carousel__indicators"
          id="sq-googlereview-carouselIndicators"
        ></div>
      </div>
    </div>

    <!-- Modal -->
    <div
      class="sq-googleReview_reviewModal-overlay"
  id="sq-googlereview-reviewModal"
      style="display: none"
    >
  <div class="sq-googleReview_reviewModal" id="sq-googlereview-modalContent">
  <button class="sq-googleReview_reviewModal-close" id="sq-googlereview-modalClose">
          âœ•
        </button>
        <div class="sq-googleReview_reviewModal-header">
          <div
            class="sq-googleReview_reviewModal-avatar"
            id="sq-googlereview-modalAvatar"
          ></div>
          <div class="sq-googleReview_reviewModal-info">
            <div class="sq-googleReview_reviewModal-nameRow">
              <span
                class="sq-googleReview_reviewModal-name"
                id="sq-googlereview-modalName"
              ></span>
              <span class="sq-googleReview_reviewModal-verifiedWrapper">
                <img
                  src="/verified.svg"
                  alt="verified"
                  class="sq-googleReview_reviewModal-verified"
                  id="sq-googlereview-modalVerified"
                />
              </span>
            </div>
            <div class="sq-googleReview_reviewModal-date" id="sq-googlereview-modalDate"></div>
          </div>
        </div>
  <div class="sq-googleReview_reviewModal-stars" id="sq-googlereview-modalStars"></div>
  <div class="sq-googleReview_reviewModal-text" id="sq-googlereview-modalText"></div>
      </div>
    </div>

    <script>
      const reviews = [
        {
          id: 4,
          name: "Sophia Martinez",
          verified: true,
          date: "2 days ago",
          rating: 5,
          text: "Absolutely loved it! Perfect for a family outing, Absolutely loved it! Perfect for a family outingAbsolutely loved itAbsolutely loved it! Perfect for a family outing! Perfect for a family outing and the view is stunning at sunset. Absolutely loved it! Perfect for a family outing, and the view is stunning at sunset.",
          // avatar: "https://i.pravatar.cc/40?img=1",
        },
        {
          id: 5,
          name: "Michael Chen",
          verified: true,
          date: "3 days ago",
          rating: 3.7,
          text: "Good experience overall but parking was difficult to find.",
          avatar: "https://i.pravatar.cc/40?img=2",
        },
        {
          id: 6,
          name: "Isabella Rossi",
          verified: true,
          date: "3 days ago",
          rating: 2.5,
          text: "The place was too crowded, couldn't enjoy as much as I hoped.",
          avatar: "https://i.pravatar.cc/40?img=3",
        },
        {
          id: 7,
          name: "Daniel Kim",
          verified: false,
          date: "4 days ago",
          rating: 4.5,
          text: "Loved the architecture, the science exhibits are engaging for kids.",
          avatar: "https://i.pravatar.cc/40?img=4",
        },
        {
          id: 8,
          name: "Emily Johnson",
          verified: true,
          date: "5 days ago",
          rating: 3,
          text: "The view is nice but the cafe prices are too high.",
          avatar: "https://i.pravatar.cc/40?img=5",
        },
        {
          id: 9,
          name: "Carlos Mendoza",
          verified: true,
          date: "6 days ago",
          rating: 5,
          text: "Un lugar increÃ­ble para visitar con amigos, las fotos salen espectaculares!",
          avatar: "https://i.pravatar.cc/40?img=6",
        },
        {
          id: 10,
          name: "Ava Brown",
          verified: false,
          date: "6 days ago",
          rating: 4.2,
          text: "Great spot for photography, but prepare for long lines.",
          avatar: "https://i.pravatar.cc/40?img=7",
        },
        {
          id: 11,
          name: "James Wilson",
          verified: true,
          date: "1 week ago",
          rating: 3.8,
          text: "Good location, parking and entry process can be improved.",
          avatar: "https://i.pravatar.cc/40?img=8",
        },
        {
          id: 12,
          name: "Olivia Davis",
          verified: true,
          date: "1 week ago",
          rating: 5,
          text: "Hands down the best experience of my LA trip!",
          avatar: "https://i.pravatar.cc/40?img=9",
        },
      ];

  const track = document.getElementById("sq-googlereview-carouselTrack");
  const indicators = document.getElementById("sq-googlereview-carouselIndicators");
  const viewport = document.getElementById("sq-googlereview-carouselViewport");
  const modal = document.getElementById("sq-googlereview-reviewModal");
  const modalClose = document.getElementById("sq-googlereview-modalClose");
  const modalName = document.getElementById("sq-googlereview-modalName");
  const modalAvatar = document.getElementById("sq-googlereview-modalAvatar");
  const modalVerified = document.getElementById("sq-googlereview-modalVerified");
  const modalDate = document.getElementById("sq-googlereview-modalDate");
  const modalStars = document.getElementById("sq-googlereview-modalStars");
  const modalText = document.getElementById("sq-googlereview-modalText");

      let currentIndex = 0;
      let itemsToShow = 1;
      const minCardWidth = 250;

      function createStarRating(value) {
        const container = document.createElement("div");
        container.className = "sq-googleReviews__stars";

        for (let i = 1; i <= 5; i++) {
          const star = document.createElement("span");
          star.className = "sq-googleReviews__star";

          if (value >= i) {
            star.classList.add("sq-googleReviews__star--full");
          } else if (value > i - 1) {
            // fractional star
            star.classList.add("sq-googleReviews__star--fractional");
            star.style.setProperty("--fill", value - (i - 1));
          }

          container.appendChild(star);
        }

        return container;
      }

      function renderSummaryStars() {
        const summaryStars = document.getElementById("sq-googlereview-summaryStars");
        summaryStars.innerHTML = "";
        summaryStars.appendChild(createStarRating(4.7));
      }

      function renderCarousel() {
        track.innerHTML = "";
        reviews.forEach((review) => {
          const card = document.createElement("div");
          card.className = "sq-googleReviews-carousel__card";

          const reviewCard = document.createElement("div");
          reviewCard.className = "sq-googleReviews__reviewCard";

          // ----- Header -----
          const header = document.createElement("div");
          header.className = "sq-googleReviews__reviewCard-headerSection";

          const cardHeader = document.createElement("div");
          cardHeader.className = "sq-googleReviews__reviewCard-header";

          // Google badge (outside avatar)
          const badge = document.createElement("img");
          badge.src = "/google-g.svg";
          badge.alt = "Google";
          badge.className = "sq-googleReviews__reviewCard-googleBadge";
          cardHeader.appendChild(badge);

          const avatar = document.createElement("div");
          avatar.className = "sq-googleReviews__reviewCard-avatar";
          if (review.avatar) {
            const img = document.createElement("img");
            img.src = review.avatar;
            img.alt = review.name;
            avatar.appendChild(img);
          } else {
            avatar.textContent = review.name[0];
          }
          cardHeader.appendChild(avatar);

          const info = document.createElement("div");
          info.className = "sq-googleReviews__reviewCard-info";

          const nameRow = document.createElement("div");
          nameRow.className = "sq-googleReviews__reviewCard-nameSection";
          const nameText = document.createElement("span");
          nameText.className = "sq-googleReviews__reviewCard-nameText";
          nameText.textContent = review.name;
          nameRow.appendChild(nameText);

          if (review.verified) {
            const verifiedIcon = document.createElement("img");
            verifiedIcon.src = "/verified.svg";
            verifiedIcon.alt = "verified";
            verifiedIcon.className = "sq-googleReviews__reviewCard-verified";
            nameRow.appendChild(verifiedIcon);
          }

          info.appendChild(nameRow);

          const date = document.createElement("div");
          date.className = "sq-googleReviews__reviewCard-date";
          date.textContent = review.date;
          info.appendChild(date);

          cardHeader.appendChild(info);
          header.appendChild(cardHeader);

          const starsContainer = document.createElement("div");
          starsContainer.className = "sq-googleReviews__reviewCard-stars";
          starsContainer.appendChild(createStarRating(review.rating));
          header.appendChild(starsContainer);

          reviewCard.appendChild(header);

          // ----- Content -----
          const content = document.createElement("div");
          content.className = "sq-googleReviews__reviewCard-contentSection";

          const text = document.createElement("span");
          text.className = "sq-googleReviews__reviewCard-text";
          text.textContent = review.text;
          content.appendChild(text);

          // --- Overflow detection ---
          requestAnimationFrame(() => {
            const isOverflowing = text.scrollHeight > text.clientHeight;
            if (isOverflowing) {
              const readMore = document.createElement("a");
              readMore.className = "sq-googleReviews__reviewCard-readMore";
              readMore.textContent = "Read more";
              readMore.href = "#";
              readMore.addEventListener("click", (e) => {
                e.preventDefault();
                openModal(review);
              });
              content.appendChild(readMore);
            }
          });

          reviewCard.appendChild(content);
          card.appendChild(reviewCard);
          track.appendChild(card);
        });

        updateCarouselPosition();
        renderIndicators();
      }

      function updateCarouselPosition() {
        const percent = (100 / itemsToShow) * currentIndex;
        track.style.transform = `translateX(-${percent}%)`;
        track.style.gridTemplateColumns = `repeat(${reviews.length}, ${
          100 / itemsToShow
        }%)`;
      }

      function renderIndicators() {
        indicators.innerHTML = "";
        for (let i = 0; i <= reviews.length - itemsToShow; i++) {
          const dot = document.createElement("div");
          dot.className = i === currentIndex ? "dots-active" : "dots-far";
          dot.addEventListener("click", () => {
            currentIndex = i;
            updateCarouselPosition();
            renderIndicators();
          });
          indicators.appendChild(dot);
        }

        const activeDot = indicators.querySelector(".dots-active");
        if (activeDot) {
          activeDot.scrollIntoView({
            behavior: "smooth",
            inline: "center",
            block: "nearest",
          });
        }
      }

      function resizeCarousel() {
        const viewportWidth = viewport.offsetWidth;
        const possibleItems = Math.floor(viewportWidth / minCardWidth);
        itemsToShow = Math.max(1, Math.min(reviews.length, possibleItems));
        if (currentIndex > reviews.length - itemsToShow)
          currentIndex = reviews.length - itemsToShow;
        updateCarouselPosition();
        renderIndicators();
      }

      window.addEventListener("resize", resizeCarousel);

  document.getElementById("sq-googlereview-prevBtn").addEventListener("click", () => {
        if (currentIndex > 0) currentIndex--;
        updateCarouselPosition();
        renderIndicators();
      });

  document.getElementById("sq-googlereview-nextBtn").addEventListener("click", () => {
        if (currentIndex < reviews.length - itemsToShow) currentIndex++;
        updateCarouselPosition();
        renderIndicators();
      });

      function openModal(review) {
        modal.style.display = "flex";
        modalName.textContent = review.name;
        modalAvatar.innerHTML = review.avatar
          ? `<img src="${review.avatar}" alt="${review.name}">`
          : review.name[0];
        modalVerified.style.display = review.verified ? "inline-block" : "none";
        modalDate.textContent = review.date;
        modalStars.innerHTML = "";
        modalStars.appendChild(createStarRating(review.rating));
        modalText.textContent = review.text;
      }

      modalClose.addEventListener("click", () => {
        modal.style.display = "none";
      });

      modal.addEventListener("click", () => {
        modal.style.display = "none";
      });

  document.getElementById("sq-googlereview-modalContent").addEventListener("click", (e) => {
        e.stopPropagation();
      });

      // Drag/swipe
      let startX = 0;
      let isDragging = false;

      viewport.addEventListener("mousedown", (e) => {
        startX = e.clientX;
        isDragging = true;
      });
      viewport.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
      });
      viewport.addEventListener("mouseup", (e) => {
        handleEnd(e.clientX);
      });
      viewport.addEventListener("mouseleave", (e) => {
        handleEnd(e.clientX);
      });

      viewport.addEventListener("touchstart", (e) => {
        startX = e.touches[0].clientX;
        isDragging = true;
      });
      viewport.addEventListener("touchend", (e) => {
        handleEnd(e.changedTouches[0].clientX);
      });

      function handleEnd(x) {
        if (!isDragging) return;
        const diff = x - startX;
        isDragging = false;
        if (Math.abs(diff) > 50) {
          if (diff < 0 && currentIndex < reviews.length - itemsToShow)
            currentIndex++;
          if (diff > 0 && currentIndex > 0) currentIndex--;
          updateCarouselPosition();
          renderIndicators();
        }
      }

      // Initial render
      renderSummaryStars();
      renderCarousel();
      resizeCarousel();
    </script>
  </body>
</html>
